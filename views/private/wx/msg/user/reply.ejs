<div class="modal-body no-p">
  <div class="row">
    <div class="col-xs-12">
      <section class="panel panel-primary no-b">
        <header class="panel-heading clearfix brtl brtr">
          <div class="overflow-hidden">
            <a href="javascript:;" class="h4 show no-m pt5">回复消息</a>
          </div>
        </header>
        <div class="list-group" style="text-align: center;padding-top: 10px;">
          <table width="80%" style="padding: 10px;">
              <tr style="height: 30px;">
              <td width="30%" align="right">回复内容：</td>
              <td width="70%" align="left">
                <textarea id="content" class="control-group" cols="50" rows="5"></textarea>
              </td>
            </tr>
          </table>
        </div>
        <div id="list">
        </div>
      </section>

    </div>
  </div>
</div>
<div class="modal-footer">
  <button type="button" class="btn btn-default" data-dismiss="modal">取 消</button>
  <button onclick="save()" id="save" type="button" class="btn btn-primary" data-loading-text="正在提交...">确 定</button>
</div>
<script type="text/javascript">
  function save(){
    if($("#content").val()==""){
      Toast.error("内容不可为空");
      $("#content").focus();
      return false;
    }
    var btn = $("#save");
    var dialog = $("#dialogDetail");
    btn.button("loading");
    $.post("/private/wx/msg/user/replyDo", {id: <%=obj.id%>,content:$("#content").val()}, function (data) {
      if (data.code == 0) {
        Toast.success("发送成功");
        dialog.modal("hide");
        datatable.ajax.reload();
      } else {
        Toast.error(data.msg);
      }
      btn.button("reset");

    }, "json");
  }
  function pagelist(start){
    $.post("/private/wx/msg/user/replyData", {openid: '<%=obj.openid%>',start:start,length:5}, function (data) {
      console.log(data);
      var str='';
      if(data.recordsTotal>0){
        $.each(data.data,function(i,o){
          str+='<div  style="width: 400px;padding:5px;margin-left: 40px;margin-bottom:5px;" class="alert alert-info">';
          str+= o.nickname+":"+ o.content;
          str+='</div>';
          if(o.replyId){
            str+='<div  style="width: 400px;padding:5px;margin-left: 140px;margin-bottom:5px;" class="alert alert-warning alert-dismissable">';
            str+= o.replyId.content;
            str+='</div>';
          }
        });
        $("#list").html(str);
      }
    }, "json");
  }
  $(function(){
    pagelist(0);
  });
</script>
