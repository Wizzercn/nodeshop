<!DOCTYPE html>
<html class="signin no-js" lang="zh-CN">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
  <meta name="description" content="<%= sails.config.system.AppName %>">
  <meta name="keywords" content="wizzer,node,nodejs,shop">
  <title><%= sails.config.system.AppName %></title>
  <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.css">
  <link rel="stylesheet" href="/css/themify-icons.css">
  <link rel="stylesheet" href="/css/animate.min.css">
  <link rel="stylesheet" href="/css/skins/palette.css">
  <link rel="stylesheet" href="/css/fonts/font.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/panel.css">
  <link rel="stylesheet" href="/plugins/jstree/themes/default/style.min.css">

  <!--[if lt IE 9]>
  <script src="/js/html5shiv.js"></script>
  <script src="/js/respond.min.js"></script>
  <script src="/js/json2.js"></script>
  <![endif]-->
  <% if(user.loginTheme){ %>
  <link rel="stylesheet" href="/css/skins/<%= user.loginTheme %>" id="skin">
  <% }else{ %>
  <link rel="stylesheet" href="/css/skins/palette.css" id="skin">
  <% } %>
  <script src="/plugins/modernizr.js"></script>
  <script src="/plugins/jquery-1.11.1.min.js"></script>
  <script src="/js/jquery.pjax.js"></script>
</head>
<body>
<div class="gallery-loader" style="background-color:transparent;">
  <div class="loader"></div>
</div>

<div class="playground hidden-xs">
  <div class="options">
    <div class="pg-close ti-close"></div>
    <div class="options-container color-options">
      <h6><%= sails.__('private.index.theme') %></h6>
      <a onclick="sublime.changeTheme('palette.css')" href="/css/skins/palette.css"
         class="css_orange cs_color cs_1 <% if(!user.loginTheme || 'palette.css' == user.loginTheme){ %>active<% } %>">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </a>
      <a onclick="sublime.changeTheme('palette.2.css')" href="/css/skins/palette.2.css"
         class="css_orange cs_color cs_2 <% if('palette.2.css' == user.loginTheme){ %>active<% } %>">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </a>
      <a onclick="sublime.changeTheme('palette.3.css')" href="/css/skins/palette.3.css"
         class="css_orange cs_color cs_3 <% if('palette.3.css' == user.loginTheme){ %>active<% } %>">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </a>
      <a onclick="sublime.changeTheme('palette.4.css')" href="/css/skins/palette.4.css"
         class="css_orange cs_color cs_4 <% if('palette.4.css' == user.loginTheme){ %>active<% } %>">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </a>
    </div><%= user.loginScroll == true %>
    <div class="options-container">
      <h6><%= sails.__('private.index.layout') %></h6>
      <a class="pg-val toggle-sidebar toggle-active <% if(user.loginSidebar){ %>active<% } %>" href="javascript:;">
        <img src="/img/panel/small.png" alt="">
      </a>
      <a class="pg-val toggle-scroll toggle-active <% if(user.loginScroll){ %>active<% } %>" href="javascript:;">
        <img src="/img/panel/scroll.png" alt="">
      </a>
      <a class="pg-val toggle-boxed toggle-active <% if(user.loginBoxed){ %>active<% } %>" href="javascript:;">
        <img src="/img/panel/boxed.png" alt="">
      </a>
    </div>
    <small class="pg-footer"><i class="ti-info-alt mr5"></i><%= sails.__('private.index.panel') %></small>
  </div>
</div>
<div
  class="app <% if(user.loginSidebar){ %>small-menu<% } %> <% if(user.loginScroll){ %>fixed-scroll<% } %> <% if(user.loginBoxed){ %>boxed<% } %>">
  <header class="header header-fixed navbar">
    <div class="brand">

      <a href="javascript:;" class="ti-menu off-left visible-xs" data-toggle="offscreen" data-move="ltr"></a>


      <a href="/sysadmin/home" class="navbar-brand">
        <img src="/img/logo.png" alt="">
                <span class="heading-font">
                <%= sails.config.system.AppName %>
                </span>
      </a>

    </div>
    <ul class="nav navbar-nav navbar-left">
      <li class="hidden-xs">

        <a href="javascript:;" class="toggle-sidebar">
          <i class="ti-menu"></i>
        </a>

      </li>

    </ul>
      <ul class="nav navbar-nav">
        <li>
          <a href="/sysadmin/home">
            <i class="ti-home"></i>
            <span>首页</span>
          </a>
        </li>
        <% if(firstMenus){ %>
        <% firstMenus.forEach(function(firstMenu){ %>

        <li class="dropdown">
          <a href="javascript:;" data-toggle="dropdown">
            <% if(firstMenu.icon){ %>
            <i class="<%= firstMenu.icon %>"></i>
            <% } %>
            <span><%= firstMenu.name %></span>
            <b class="caret"></b>
          </a>
          <ul class="dropdown-menu">
            <% if(secondMenus[firstMenu.path]){ %>
            <% secondMenus[firstMenu.path].forEach(function(secondMenu){ %>
            <li class="dropdown">
              <a href="<% if(secondMenu.url){ %> <%= secondMenu.url %> <% }else{ %>javascript:;<% } %>">
                <% if(secondMenus[secondMenu.path]){ %><i class="toggle-accordion"></i><%}%>
                <span><%= secondMenu.name %></span>
              </a>
              <% if(secondMenus[secondMenu.path]){ %>
              <ul class="sub-menu">
                <% secondMenus[secondMenu.path].forEach(function(thMenu){ %>
                <li class="clearfix" >
                  <a <% if(thMenu.url){ %>href="<%= thMenu.url %>" <% }else{ %>href="javascript:;"
                    <% } %>>
                  <span><%= thMenu.name %></span>
                  </a>
                </li>
                <% });%>
              </ul>
              <%}%>
            </li>

            <% });} %>
          </ul>
        </li>
        <% });} %>

      </ul>
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown hidden-xs">
        <a href="javascript:;" data-toggle="dropdown">
          <i class="ti-more-alt"></i>
        </a>
        <ul class="dropdown-menu animated zoomIn">
          <li class="dropdown-header">Quick Links</li>
          <li>
            <a href="javascript:;">Start New Campaign</a>
          </li>
          <li>
            <a href="javascript:;">Review Campaigns</a>
          </li>
          <li class="divider"></li>
          <li>
            <a href="javascript:;">Settings</a>
          </li>
          <li>
            <a href="javascript:;">Wish List</a>
          </li>
          <li>
            <a href="javascript:;">Purchases History</a>
          </li>
          <li class="divider"></li>
          <li>
            <a href="javascript:;">Activity Log</a>
          </li>
          <li>
            <a href="javascript:;">Settings</a>
          </li>
          <li>
            <a href="javascript:;">System Reports</a>
          </li>
          <li class="divider"></li>
          <li>
            <a href="javascript:;">Help</a>
          </li>
          <li>
            <a href="javascript:;">Report a Problem</a>
          </li>
        </ul>
      </li>

      <li class="notifications dropdown">
        <a href="javascript:;" data-toggle="dropdown">
          <i class="ti-bell"></i>

          <div class="badge badge-top bg-danger animated flash">
            <span>3</span>
          </div>
        </a>

        <div class="dropdown-menu animated fadeInLeft">
          <div class="panel panel-default no-m">
            <div class="panel-heading small"><b>Notifications</b>
            </div>

            <ul class="list-group">
              <li class="list-group-item">
                <a href="javascript:;">
                                    <span class="pull-left mt5 mr15">
                                    <img src="/img/face4.jpg" class="avatar avatar-sm img-circle" alt="">
                                    </span>

                  <div class="m-body">
                    <div class="">
                      <small><b>CRYSTAL BROWN</b></small>
                      <span class="label label-danger pull-right">ASSIGN AGENT</span>
                    </div>
                    <span>Opened a support query</span>
                    <span class="time small">2 mins ago</span>
                  </div>
                </a>
              </li>
              <li class="list-group-item">
                <a href="javascript:;">
                  <div class="pull-left mt5 mr15">
                    <div class="circle-icon bg-danger">
                      <i class="ti-download"></i>
                    </div>
                  </div>
                  <div class="m-body">
                    <span>Upload Progress</span>

                    <div class="progress progress-xs mt5 mb5">
                      <div class="progress-bar" role="progressbar" aria-valuenow="40"
                           aria-valuemin="0" aria-valuemax="100" style="width: 40%">
                      </div>
                    </div>
                    <span class="time small">Submited 23 mins ago</span>
                  </div>
                </a>
              </li>
              <li class="list-group-item">
                <a href="javascript:;">
                                    <span class="pull-left mt5 mr15">
                                    <img src="/img/face3.jpg" class="avatar avatar-sm img-circle" alt="">
                                    </span>

                  <div class="m-body">
                    <em>Status Update:</em>
                    <span>All servers now online</span>
                    <span class="time small">5 days ago</span>
                  </div>
                </a>
              </li>
            </ul>
            <div class="panel-footer">
              <a href="javascript:;">See all notifications</a>
            </div>
          </div>
        </div>
      </li>
      <li class="dropdown hidden-xs">
        <a href="javascript:;" class="pg-toggle">
          <i class="ti-palette"></i>
        </a>
      </li>

      <!-- START Language list-->
      <li class="language-dropdown dropdown hidden-xs">
        <a href="javascript:;" data-toggle="dropdown" id="language">
          <% if('zh' == lang){ %>
          <img src="/img/flags/cn.png" class="flag">
          <span class="language"></span>
          <% }else{ %>
          <img src="/img/flags/us.png" class="flag">
          <span class="language"></span>
          <% } %>
        </a>
        <ul class="dropdown-menu dropdown-menu-right animated fadeInUp">
          <li>
            <a href="/private/login/lang/en">
              <img src="/img/flags/us.png" class="flag">
              <span class="language">English</span>
            </a>
          </li>
          <li>
            <a href="/private/login/lang/zh">
              <img src="/img/flags/cn.png" class="flag">
              <span class="language">中文</span>
            </a>
          </li>
        </ul>
      </li>
      <!-- END Language list    -->

      <li class="off-right">
        <a href="javascript:;" data-toggle="dropdown">
          <span class="hidden-xs ml10"><%- user.nickname %></span>
          <i class="ti-angle-down ti-caret hidden-xs"></i>
        </a>
        <ul class="dropdown-menu animated fadeInLeft">
          <li>
            <a href="#"><%= sails.__('private.index.usersetting') %></a>
          </li>
          <li>
            <a href="#" data-toggle="modal"
               data-target="#homeChangePassword"><%= sails.__('private.index.userpassword') %></a>
          </li>
        </ul>
      </li>
      <li class="off-right hidden-xs">
        <a href="/private/login/logout">
          <i class="ti-power-off"></i>
        </a>
      </li>
    </ul>
  </header>
  <section class="layout">

    <aside class="sidebar offscreen-left">

      <nav class="main-navigation" data-height="auto" data-size="6px" data-distance="0" data-rail-visible="true"
           data-wheel-step="10">
        <p class="nav-title">MENU</p>
        <ul class="nav">

          <% if(path.length > 8 && secondMenus[path.substring(0, path.length - 8)]){ %>
          <% secondMenus[path.substring(0, path.length - 8)].forEach(function(firstMenu){ %>
          <li <% if(path == firstMenu.path){ %>class="active"
              <% }else if(path.indexOf(firstMenu.path) == 0){ %>class="open"
            <% } %>
            >
            <a <% if(firstMenu.url){ %>href="<%= firstMenu.url %>" <%if('data-pjax'==firstMenu.target){%>data-pjax<%}%><% }else{ %>href="javascript:;"
              <% } %>
              >
              <% if(secondMenus[firstMenu.path]){ %>
              <i class="toggle-accordion"></i>
              <% } %>
              <% if(firstMenu.icon){ %>
              <i class="<%= firstMenu.icon %>"></i>
              <% }else{ %>
              <i class="ti-map"></i>
              <% } %>
              <span><%= firstMenu.name %></span>

            </a>
            <% if(secondMenus[firstMenu.path]){ %>
            <ul class="sub-menu">
              <% secondMenus[firstMenu.path].forEach(function(secondMenu){ %>

              <li <% if(path == secondMenu.path){ %>class="active"
                  <% }else if(path.indexOf(secondMenu.path) == 0){ %>class="open"
                <% } %>
                >
                <a <% if(secondMenu.url){ %>href="<%= secondMenu.url %>" <%if('data-pjax'==secondMenu.target){%>data-pjax<%}%><% }else{ %>href="javascript:;"<% } %>
                  >
                  <% if(secondMenus[secondMenu.path]){ %>
                  <i class="toggle-accordion"></i>
                  <% } %>
                  <span><%= secondMenu.name %></span>
                </a>
              </li>

              <% }); %>
            </ul>
            <% } %>
          </li>
          <% });}else{ %>
          <li class="open">
            <a href="javascript:;">
              <i class="toggle-accordion"></i>
              <i class="ti-heart"></i>
              <span>常用菜单</span>
            </a>
            <ul class="sub-menu">
              <li class="active">
                <a href="forms.html">
                  <span>订单管理</span>
                </a>
              </li>
            </ul>
          </li>
          <% } %>

        </ul>
      </nav>
    </aside>
    <section class="main-content" id="container">
      <%- body %>
    </section>
  </section>


</div>
<form id="passForm" role="form" class="form-horizontal parsley-form" data-parsley-validate
      action="/private/sys/user/doChangePassword" method="post">
  <div id="homeChangePassword" class="modal fade bs-modal-sm" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <h4 class="modal-title"><%= sails.__('private.index.userpassword') %></h4>
        </div>
        <div class="modal-body">

          <div class="row">
            <div class="col-lg-12">
              <div class="form">
                <label for="password" class="col-sm-2 control-label">原密码</label>

                <div class="col-sm-8">
                  <input id="oldPassword" tabindex="1" type="password" class="form-control" name="oldPassword"
                         data-parsley-required="true" placeholder="原密码">
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="form">
                <label for="password" class="col-sm-2 control-label">新密码</label>
                <div class="col-sm-8">
                  <input id="newPassword" tabindex="2" type="password" class="form-control" name="newPassword"
                         data-parsley-required="true" data-parsley-minlength="6" data-parsley-maxlength="20"  placeholder="新密码">
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="form">
                <label for="passwordAgain" class="col-sm-2 control-label">确认密码</label>

                <div class="col-sm-8">
                  <input id="passwordAgain" type="password" tabindex="6" class="form-control"
                         data-parsley-equalto="#newPassword"
                         data-parsley-required="true" name="eqPassword" placeholder="请再输入一次密码">
                </div>
              </div>
            </div>
          </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">取 消</button>
          <button type="submit" class="btn btn-primary">确 认</button>
        </div>
      </div>
    </div>
  </div>
</form>
<!--script-->
<script src="/bootstrap/js/bootstrap.js"></script>
<script src="/plugins/jquery.form.js"></script>
<script src="/plugins/parsley.min.js"></script>
<% if('zh' == lang){ %>
<script src="/plugins/parsley.zh_cn.js"></script>
<% } %>
<script src="/plugins/jquery.nestable.js"></script>
<script src="/plugins/icheck/icheck.js"></script>
<script src="/plugins/jquery.slimscroll.min.js"></script>
<script src="/plugins/jquery.easing.min.js"></script>
<script src="/plugins/appear/jquery.appear.js"></script>
<script src="/plugins/jquery.placeholder.js"></script>
<script src="/plugins/fastclick.js"></script>
<script src="/plugins/count-to/jquery.countTo.js"></script>
<script src="/js/toast.js"></script>
<script src="/js/treetable.js"></script>
<script src="/js/datatables.js"></script>
<script src="/plugins/jstree/jstree.min.js"></script>
<script src="/js/offscreen.js"></script>
<script src="/js/main.js"></script>
<script type="text/javascript">
  $(document).ready(function () {
    if($.support.pjax) {
      $(document).pjax('a[data-pjax]', '#container', {fragment: '#container', timeout: 8000});
      $('.main-navigation a[data-pjax]').on('click',function(){
        $('.main-navigation a[data-pjax]').each(function(){
          $(this).parent().removeClass('active');
        });
        $(this).parent().addClass('active');
      });
      $(document).on('pjax:send', function () { //pjax链接点击后显示加载动画；
        $(".gallery-loader").fadeIn();
      });
      $(document).on('pjax:complete', function () { //pjax链接加载完成后隐藏加载动画；
        setTimeout(function(){$(".gallery-loader").fadeOut()},500);
      });
    }
    try {
      $(".gallery-loader").fadeOut();
    } catch (e) {
    }
    $('#homeChangePassword').on('hidden.bs.modal',function(){
      $("#passForm")[0].reset();
    });
    $("#passForm").ajaxForm({
      dataType: 'json',
      beforeSubmit: function (arr, form, options) {
        form.find("button:submit").text("提交...");
        form.find("button:submit").attr("disabled", "disabled");
      },
      success: function (data, statusText, xhr, form) {
        if (data.code == 0) {
          $('#homeChangePassword').modal('hide');
          Toast.success(data.msg);
          form.find("button:submit").text("确 认");
          $("#passForm")[0].reset();
        } else {
          form.find("button:submit").text("确 认");
          form.find("button:submit").removeAttr("disabled");
          Toast.error(data.msg);
        }

      }
    });
  });

</script>
<!--script-->
</body>
</html>
